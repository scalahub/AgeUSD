{
  "constants": [
    {
      "name": "oraclePoolNFT",
      "type": "CollByte",
      "value": "54acaa0c6d5d3bc66b88364a423b5f156ed763f7236d437adb44d70787bc0f95"
    },
    {
      "name": "bankNFT",
      "type": "CollByte",
      "value": "1c648386f0529cc44c367cf941ede13533223f97b4560a0b31fa3ef668c3be62"
    },
    {
      "name": "bankAddress",
      "type": "Address",
      "value": "2zYVHmdQDGtyyZfeqFPdMFqWzMdK299yCj5uDJjiSxRgpHyjiV3mVfZCimFbEVkNkCuypT1khjhupnEb6af3ztdatgag24UzLjW7heidiBF4MqK42TBZC1mLNcm851mdBMW88XX81fNZnDW33C3DyuDSXSZmcpdasxr2GCRntrw6USxLQPxtxGpm8kp95iFHbiQfytk8mqFwJH5Lr3NrwFQWG9aNK7Ud4rTiT5S5SDMREAnQ76orAjbBjHspAh6t9hKgs2UnEj3EsC819oVRfaGmbCQStcnoKNUNYPSbBT7y1sGZL1gy5tXGvEwvX6TxEzgYyKmLq6MX9k2Zpqwtky6ERxkF7RVqvbQL28KLqf7VzqmsRU5WtLVSnJnuxS9XaJRC6WM5MH8fxhjvS4V9abodzVpyxEgMYiAmM9Jb72TLWvhJeE66rbLpqZD7CNrieUQbJaSJR5q2QqvehSdrecZRbapa4SLQYPnumHPgmd2okjTQs7dXecprHyGDH7P1TgBf66Rso2zNHryx3UCnPXRuZsWMjcv8cjk9dUjbSXqj1KQC3BEpcBkS8LULCuVNhbFYrd2e4uSXvbKg7qvFznJZonKVwXPN2meVWqJqFHgwZvZ98r8EQSFkRq1yauNPqkvzzQZ7Bep1wUELopBxT5J6ikucitYwEzXXLerSxWFAuqMYTJ2WUPyjcJphxo8Z6NHLiCGXfhFu26g4W5XBMSE4iTVZwHk8VcRd5Q6CqAa4tBPmmSxz2JCnjhpH2imZcNmjT2NH5QMmgFhpARktDcUhGHHQM9njEFcEGXqxCkGrrdqLChA1buM6YpBMgSPEMQGPrjQ7skzRjftE3Aq1mpZwAxnp3xEokPrnHmRXqHRgZoUZcoxhG6S4uhfmcM3KdJZvLAvn2YFHWcUk"
    },
    {
      "name": "poolAddresses",
      "type": "Address",
      "values": [
        "8D6pdYVRvF6PeiuSWVBR4x2RqKKCjPPqMyTpmRho6EpfWMqnwN4uedKYYTkniyKPEjnjHXpLFLD9HaVCYV7vkSNeQkjLXkQyvK8UvQuACZQw1BjpgmJc8gpkT5Ckd9X6XCpEzxQAgDzoDC4Kyq3XQtKmwap4htAk9RAcnGEbKWqyWdkLV8iSqETLj5f9ARBrU8CZwpCNZHxxpbWLZ9wPrxQMwenyQce23v7qcWkKsHkxSvQbfeyjV2wcXUGQchbwEUrtzBYLUQNBDqctQoK1mAt1V69TQDs7NxxrQcdaNmHoNkp6EVbioYNdezbjascXzfEcwXkzMmwFBhHCHwA51yHGQ66fVkLtU23iWsmkn6y14FdmQFauV23MFY5D4QTdDzExT8h7J2gaqxqqSUDXbmqcuKpoCRAisEKtSStFCHgRFeHCeRsJXNPHe7CXXutVKJpopcJdNXRtuGDw6vzoXBKJ1W7HHbF5GmQcHHBdRMMysKFZo7gwmAXB9DyUKH4UowQeaQ5R3hWzy1o4ES1fj2VPSTo7ypEJpk9Gpf8Vq6ybpeFb5ZFpsyvY3fpW3",
        "7DY5qpcRgHc59umTpZQT7MjtbdgEBE3nbGCNmqTd7w3Tk4jhm3Su661UAGWajoUMtBZDsc8PcmvbU4EuJUdW1dRcyXYZrQ4RpUNikekBXHCCp5vtSqzbq56DpUkcB3j1g3Fg8NmZKyciEJzqTPbnYAfRsip3e1DAiyuPCJTk1vbPkSqdEg9TpmmzBB5e4sAN4HqhDpsFRxvGuKM78uHrhVsZ8be9WgmNvmk4XeWrFMzwDxYa4dK1Gr679x86jdgknuJQoB4cq9TdQ1tCDbsCNQhBBa7ajzgLyXfDuP1oWGg9WHYfm9wEHAxKHxtRgmWL8Et9RryNdqbUWndREAkjbda5HED52Vhtvf91D9ryUjLYeefeBmJY2g6D4sWJGgoVKmYMrvB3phBb84Ng8epKcnRX9csdPoEJzijW7YfLVJis3p4KUeMfoKuXoLh8MBa2dF2D613E2dQbGgbFibpymGycvsMCBM1g2vdCtvw"
      ]
    },
    {
      "name": "myAddress",
      "type": "Address",
      "value": "9hz1B19M44TNpmVe8MS4xvXyycehh5uP5aCfj4a6iAowj88hkd2"
    },
    {
      "name": "scCircDelta",
      "type": "Long",
      "value": "-1"
    },
    {
      "name": "0",
      "type": "Long",
      "value": "0"
    },
    {
      "name": "1",
      "type": "Long",
      "value": "1"
    },
    {
      "name": "feePercent",
      "type": "Long",
      "value": "1"
    },
    {
      "name": "100",
      "type": "Long",
      "value": "100"
    },
    {
      "name": "INF",
      "type": "Long",
      "value": "100000000000"
    },
    {
      "name": "minStorageRent",
      "type": "Long",
      "value": "10000000"
    }
  ],
  "dataInputs": [
    {
      "address": {
        "value": "poolAddresses"
      },
      "registers": [
        {
          "num": "R4",
          "name": "rateUSD",
          "type": "Long"
        }
      ]
    }
  ],
  "inputs": [
    {
      "address": {
        "value": "bankAddress"
      },
      "tokens": [
        {
          "index": 0,
          "id": {
            "name": "scToken"
          },
          "amount": {
            "name": "scTokenIn"
          }
        },
        {
          "index": 1,
          "id": {
            "name": "rcToken"
          },
          "amount": {
            "name": "rcTokenIn"
          }
        },
        {
          "index": 2,
          "id": {
            "value": "bankNFT"
          },
          "amount": {
            "value": "1"
          }
        }
      ],
      "registers": [
        {
          "num": "R4",
          "name": "scCircIn",
          "type": "Long"
        },
        {
          "num": "R5",
          "name": "rcCircIn",
          "type": "Long"
        }
      ],
      "nanoErgs": {
        "name": "bcReserveIn"
      },
      "options": [
        "Strict"
      ]
    },
    {
      "address": {
        "value": "myAddress"
      },
      "tokens": [
        {
          "id": {
            "value": "scToken"
          },
          "amount": {
            "value": "scCircDeltaAbs",
            "filter": "Ge"
          }
        }
      ]
    }
  ],
  "outputs": [
    {
      "address": {
        "value": "bankAddress"
      },
      "tokens": [
        {
          "index": 0,
          "id": {
            "value": "scToken"
          },
          "amount": {
            "value": "scTokenOut"
          }
        },
        {
          "index": 1,
          "id": {
            "value": "rcToken"
          },
          "amount": {
            "value": "rcTokenIn"
          }
        },
        {
          "index": 2,
          "id": {
            "value": "bankNFT"
          },
          "amount": {
            "value": "1"
          }
        }
      ],
      "registers": [
        {
          "num": "R4",
          "value": "scCircOut",
          "type": "Long"
        },
        {
          "num": "R5",
          "value": "rcCircIn",
          "type": "Long"
        }
      ],
      "nanoErgs": {
        "value": "bcReserveOut"
      }
    },
    {
      "address": {
        "value": "myAddress"
      },
      "registers": [
        {
          "value": "scCircDelta",
          "num": "R4",
          "type": "Long"
        },
        {
          "value": "bcDeltaWithFee",
          "num": "R5",
          "type": "Long"
        }
      ],
      "nanoErgs": {
        "value": "bcDeltaWithFeeAbs"
      }
    }
  ],
  "unaryOps": [
    {
      "name": "fee * -1",
      "op": "Neg",
      "from": "fee"
    },
    {
      "name": "scCircDeltaAbs",
      "op": "Abs",
      "from": "scCircDelta"
    },
    {
      "name": "bcDeltaWithFeeAbs",
      "op": "Abs",
      "from": "bcDeltaWithFee"
    }
  ],
  "branches": [
    {
      "name": "liableRate",
      "ifTrue": "INF",
      "ifFalse": "liabilitiesIn / scCircIn",
      "condition": {
        "first": "scCircIn",
        "second": "0",
        "op": "Eq"
      }
    },
    {
      "name": "actualFee",
      "ifTrue": "fee * -1",
      "ifFalse": "fee",
      "condition": {
        "first": "fee",
        "second": "0",
        "op": "Lt"
      }
    }
  ],
  "binaryOps": [
    {
      "name": "scTokenOut",
      "first": "scTokenIn",
      "op": "Sub",
      "second": "scCircDelta"
    },
    {
      "name": "scCircOut",
      "first": "scCircIn",
      "op": "Add",
      "second": "scCircDelta"
    },
    {
      "name": "rate",
      "first": "rateUSD",
      "op": "Div",
      "second": "100"
    },
    {
      "name": "bcReserveNeededIn",
      "first": "rate",
      "op": "Mul",
      "second": "scCircIn"
    },
    {
      "name": "liabilitiesIn",
      "first": "bcReserveIn",
      "op": "Min",
      "second": "bcReserveNeededIn"
    },
    {
      "name": "liabilitiesIn / scCircIn",
      "first": "liabilitiesIn",
      "op": "Div",
      "second": "scCircIn"
    },
    {
      "name": "scNominalPrice",
      "first": "rate",
      "op": "Min",
      "second": "liableRate"
    },
    {
      "name": "bcDelta",
      "first": "scNominalPrice",
      "op": "Mul",
      "second": "scCircDelta"
    },
    {
      "name": "bcDelta * feePercent",
      "first": "bcDelta",
      "op": "Mul",
      "second": "feePercent"
    },
    {
      "name": "fee",
      "first": "bcDelta * feePercent",
      "op": "Div",
      "second": "100"
    },
    {
      "name": "bcDeltaWithFee",
      "first": "bcDelta",
      "op": "Add",
      "second": "actualFee"
    },
    {
      "name": "bcReserveOut",
      "first": "bcReserveIn",
      "op": "Add",
      "second": "bcDeltaWithFee"
    }
  ],
  "fee": 2000000,
  "returns": [
    "scToken",
    "rcToken",
    "bankNFT",
    "scTokenIn",
    "rcTokenIn",
    "scCircIn",
    "rcCircIn",
    "bcReserveIn",
    "scCircDelta",
    "bcDelta",
    "bcDeltaWithFee",
    "scNominalPrice",
    "rateUSD",
    "rate"
  ]
}
